\documentclass[12pt,a4paper]{report}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{lmodern}
\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}
\usepackage{ucs}
\usepackage{icomma}
\usepackage{siunitx}
\usepackage{subfiles}
\usepackage[hyphens]{url}
\usepackage[numbib,nottoc]{tocbibind}
\usepackage{mathtools}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\usepackage[bookmarks,hidelinks]{hyperref}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subfiles}
\usepackage{subfigure}
\usepackage{listings}
\usepackage{float}
\usepackage{booktabs}
\usepackage{titling}
\graphicspath{{../fig/}{./fig/}}
\renewcommand{\baselinestretch}{1.5}
\lstset{
  language=Matlab,
  keywordstyle=\bfseries\ttfamily\color[rgb]{0,0,1},
  identifierstyle=\ttfamily,
  commentstyle=\color[rgb]{0.133,0.545,0.133},
  stringstyle=\ttfamily\color[rgb]{0.627,0.126,0.941},
  showstringspaces=false,
  basicstyle=\small,
  numberstyle=\footnotesize,
  numbers=left,
  stepnumber=5,
  numberfirstline=true,
  breaklines=true,
  breakatwhitespace=false,
  frame=single
} 
\begin{document}
\title{Simulating mixing particles}
\author{Daniel O. Fejerskov, Mikkel S. Andersen Bennetsen,\\ Nathan H. Barr}
\maketitle
\tableofcontents

\chapter{Introduction}
In this report, we will simulate a system consisting of two different kinds of particles. In order to facilitate the presentation of the actual simulation itself, the first part of this report will be largely theoretical in nature. Here, we will describe the physical nature of the process that takes place when different kinds of particles interact and mix. The simulation itself is a Monte Carlo simulation, or more specifically the Metropolis algorithm. As this method of simulation was introduced in an earlier report in this course, we will not describe it in great detail, and only where it has relevance to the simulation itself. The second part of the report presents the method of simulation, as well as the results of it.

\chapter{Theory of Mixing}
In this section, we introduce the more important physical terms used in the report, and their relevance to the system we simulate. The goal of this report is to be able to make observations regarding the way the two types of particles interact. Specifically, a focal point of the report is to be able to show a phase diagram of their mixture. Further, we will be able to calculate, among other things the pressure of the system. This is done by determining the heat capacity of the system. From this we can calculate the entropy of the system, as a function of temperature. This result, in turn, we can use to calculate the Gibbs free energy of the system. This finally allows us to determine the pressure of the system.

\section{Heat Capacity and Entropy}
To calculate the heat capacity, we use the fluctuation function:

\begin{equation}
C_V = \left( \frac{\partial \langle E \rangle}{\partial T} \right)_{V,N}
\end{equation}
Here, the energy is simply an ensemble average. The point of calculating the heat capacity of our system is to be able to calculate the entropy. The calculation is naturally not straightforward in a simulation, but the general way of undertaking the operation is to realise that the heat capacity is related to the entropy by:
\begin{equation}
\frac{C_V}{T} = \left( \frac{\partial S}{\partial T}\right)_V
\end{equation}
In turn, this means that:

\begin{equation}
S = \int^{T_f}_{T_i} \frac{C_V}{T}\ dT
\end{equation}
Following this, we shall perform a thermodynamic integration of our result. This essentially means that we integrate at several different temperatures, in order to obtain the entropy of the system, as written above. In the next section, we summarise why this result is useful for calculating the Gibbs free energy and the pressure.

\subfile{gibbs.tex}




\chapter{Simulation}

\section{Calculating Entropy}
As seen, entropy can be calculated by an integral, but before that can be used, we need an initial condition. The following is how we have calculated the initial condition where the temperature is equal to $\infty$. When our temperature approaches $\infty$, all states become equally probable. The multiplicity can be calculated as:

\begin{align}
\Omega=&\binom{N_A+N_B}{N_A}\binom{L^2}{N_A+N_B}, \;\; N_A+N_B\neq 0\\
=&\left(\frac{(N_A+N_B)!}{N_A!(N_A+N_B-N_A)!}\right) \left(\frac{L^2!}{(N_A+N_B)!(L^2-N_A+N_B)!}\right)
\end{align}
The entropy can be calculated as:

\begin{align}
S =& k_b \ln \left( \frac{(N_A+N_B)!}{N_A!(N_A+N_B-N_A)!}\right) \left( \frac{L^2!}{(N_A+N_B)!(L^2-N_A+N_B)!}\right)\\
=& k_b \left( \ln(m!)-\ln(N_A!)-\ln((m-N_A)!)+\ln(L^2!)-\ln(m!)- \ln((L^2-m)!) \right)\\
\approx& k_b [ m\ln(m)-m -((N_A\ln(N_A)-N_A)) - ((m-N_A)\ln(m-N_A)-(m-N_A)) \\ 
& +(L^2 \ln(L^2)-L^2)-(m\ln(m)-m)-((L^2-m)\ln(L^2-m)-(L^2-m)) ] \\
=& k_b[	m\ln(m)-m - N_A\ln(N_A)+N_A-(m-N_A)\ln(m-N_A)+m-N_A \\
& +L^2\ln(L^2)-L^2 - m\ln(m)+m - (L^2-m)\ln(L^2-m)+L^2-m] \\
=& -N_A\ln(N_A)-(m-N_A)\ln(m-N_A)+L^2\ln(L^2)-(L^2-m)\ln(L^2-m)\\
=& -N_A\ln(N_A)-(N_B)\ln(N_B)+2L^2\ln(L)-(L^2-N_A-N_B)\ln(L^2-N_A-N_B)
\end{align}
Normally you can not use $S = k_b\ln(\Omega)$, but at temperature $T=\infty$, we can work in a micro canonical ensemble because all states have an equal probability and equal energy.  


\chapter{Conclusion}


\end{document}